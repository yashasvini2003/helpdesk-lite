{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Tickets</h2>
  <form class="d-flex" method="get" action="{{ url_for('list_tickets') }}">
    <label class="me-2">Status:</label>
    <select name="status" class="form-select form-select-sm me-2">
      <option value="all" {% if status_filter == "all" %}selected{% endif %}>All</option>
      <option value="Open" {% if status_filter == "Open" %}selected{% endif %}>Open</option>
      <option value="In Progress" {% if status_filter == "In Progress" %}selected{% endif %}>In Progress</option>
      <option value="Resolved" {% if status_filter == "Resolved" %}selected{% endif %}>Resolved</option>
      <option value="Closed" {% if status_filter == "Closed" %}selected{% endif %}>Closed</option>
    </select>
    <button class="btn btn-primary btn-sm" type="submit">Filter</button>
  </form>
</div>

<table class="table table-striped table-hover align-middle">
  <thead>
    <tr>
      <th>ID</th>
      <th>Title</th>
      <th>Requester</th>
      <th>Device</th>
      <th>Priority</th>
      <th>Status</th>
      <th>Created</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for ticket in tickets %}
      <tr>
        <td>{{ ticket.id }}</td>
        <td>{{ ticket.title }}</td>
        <td>{{ ticket.requester_name }}</td>
        <td>{{ ticket.device_type }}</td>
        <td>{{ ticket.priority }}</td>
        <td>{{ ticket.status }}</td>
        <td>{{ ticket.created_at }}</td>
        <td>
          <a href="{{ url_for('ticket_detail', ticket_id=ticket.id) }}" class="btn btn-sm btn-outline-secondary">
            View
          </a>
        </td>
      </tr>
    {% else %}
      <tr>
        <td colspan="8" class="text-center">No tickets found.</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
